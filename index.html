<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>myVicRoads</title>
    <style>
        :root {
            --vic-navy: #1d2b3a;
            --vic-red: #e1251b;
            --vic-green: #008751;
            --vic-bg: #f8fafb;
            --vic-mint: #C3E1BB;
            --text-dark: #1c1c1e;
            --text-light: #6e6e73;
            --pin-bg: #f2f4f7;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; margin: 0; background: var(--vic-bg); color: var(--text-dark); height: 100vh; overflow: hidden; }

        /* PASSCODE SCREEN - ANY PIN WORKS */
        #screen-pin { position: fixed; inset: 0; background: white; z-index: 10000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .pin-lock-icon { width: 60px; height: 60px; background: var(--vic-navy); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; }
        .pin-dots { display: flex; gap: 15px; margin-bottom: 50px; }
        .pin-dot { width: 45px; height: 55px; border: 1.5px solid #d1d1d6; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .pin-dot.filled { border-color: var(--vic-navy); }
        .pin-keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; width: 85%; max-width: 320px; }
        .key { height: 65px; background: var(--pin-bg); border: none; border-radius: 12px; font-size: 24px; font-weight: 600; display: flex; align-items: center; justify-content: center; cursor: pointer; }

        /* SCREENS */
        .screen { display: none; height: 100vh; width: 100vw; flex-direction: column; overflow-y: auto; padding-bottom: 110px; }
        .screen.active { display: flex; }

        /* HOME SCREEN */
        .header-main { padding: 50px 20px 10px; font-size: 34px; font-weight: 700; user-select: none; }
        .stat-card { background: white; border-radius: 12px; padding: 22px; margin: 10px 16px; display: flex; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.03); }
        .licence-card { background: linear-gradient(135deg, #2b3a4a, #111a24); color: white; border-radius: 16px; padding: 25px; margin: 10px 16px; position: relative; }

        /* LICENCE PAGE - MATCHED DIMENSIONS */
        .lic-nav { background: white; padding: 15px; display: flex; align-items: center; border-bottom: 1px solid #eee; position: sticky; top: 0; z-index: 10; }
        .refresh-bar { padding: 12px 20px; font-size: 12px; color: var(--text-light); background: white; }
        .banner-red { background: var(--vic-red); color: white; padding: 18px 20px; font-weight: 800; font-size: 14px; }
        
        .mint-box { background: var(--vic-mint); padding: 20px; display: flex; gap: 15px; justify-content: center; align-items: stretch; }
        
        /* Photo and QR Card: Perfectly Matched */
        #profile-img { width: 145px; height: 185px; border-radius: 8px; object-fit: cover; background: white; border: 1px solid #ddd; }
        .qr-card { width: 145px; height: 185px; background: white; border-radius: 12px; padding: 12px; text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .btn-reveal { background: var(--vic-navy); color: white; border: none; padding: 10px 5px; border-radius: 20px; font-weight: 700; font-size: 11px; margin-top: 8px; width: 100%; }

        /* DETAILS */
        .details-pane { background: white; padding: 20px; }
        .grid-row { display: flex; margin-bottom: 22px; }
        .grid-col { flex: 1; }
        .label { font-size: 11px; color: var(--text-light); margin-bottom: 5px; text-transform: uppercase; font-weight: 700; }
        .value { font-size: 16px; font-weight: 600; }
        .section-break { background: #f2f2f7; padding: 12px 20px; font-weight: 700; font-size: 13px; color: var(--text-light); border-top: 1px solid #eee; }
        #signature-img { height: 60px; max-width: 200px; object-fit: contain; filter: grayscale(1); }

        /* ADMIN PANEL */
        #admin-panel { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 10001; display: none; flex-direction: column; padding: 20px; overflow-y: auto; color: white; }
        #admin-panel input { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: none; font-size: 16px; }
        .admin-btn { background: var(--vic-green); color: white; padding: 15px; border: none; border-radius: 10px; font-weight: 700; margin-top: 10px; }

        /* NAV BAR */
        .nav-bar { position: fixed; bottom: 0; width: 100%; height: 95px; background: white; border-top: 1px solid #ddd; display: flex; justify-content: space-around; padding-top: 12px; }
        .nav-btn { display: flex; flex-direction: column; align-items: center; width: 20%; color: #8e8e93; font-size: 11px; font-weight: 600; }
        .nav-icon { width: 26px; height: 26px; margin-bottom: 4px; fill: none; stroke: currentColor; stroke-width: 2; }
        
        /* Home Icon Logic */
        .nav-btn.active { color: var(--vic-green); }
        .home-pill { background: #f0f9f4; border-radius: 20px; padding: 4px 14px; margin-bottom: 4px; display: none; }
        .active .home-pill { display: block; }
    </style>
</head>
<body>

    <div id="screen-pin">
        <div class="pin-lock-icon"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg></div>
        <div style="font-size:24px; font-weight:700; margin-bottom:40px;">Enter PIN</div>
        <div class="pin-dots"><div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div><div class="pin-dot"></div></div>
        <div class="pin-keypad">
            <div class="key" onclick="press('1')">1</div><div class="key" onclick="press('2')">2</div><div class="key" onclick="press('3')">3</div>
            <div class="key" onclick="press('4')">4</div><div class="key" onclick="press('5')">5</div><div class="key" onclick="press('6')">6</div>
            <div class="key" onclick="press('7')">7</div><div class="key" onclick="press('8')">8</div><div class="key" onclick="press('9')">9</div>
            <div style="background:transparent"></div><div class="key" onclick="press('0')">0</div><div class="key" onclick="del()">⌫</div>
        </div>
    </div>

    <div id="admin-panel">
        <h2>Secret Admin Settings</h2>
        <input type="text" id="edit-name" placeholder="Full Name">
        <input type="text" id="edit-num" placeholder="Permit Number">
        <input type="text" id="edit-exp" placeholder="Expiry Date">
        <input type="text" id="edit-dob" placeholder="Date of Birth">
        <input type="text" id="edit-addr" placeholder="Address">
        <p>Profile Photo:</p><input type="file" id="edit-photo" accept="image/*">
        <p>Signature Photo:</p><input type="file" id="edit-sig" accept="image/*">
        <button class="admin-btn" onclick="applyChanges()">Save and Close</button>
        <button class="admin-btn" style="background:#555" onclick="toggleAdmin()">Cancel</button>
    </div>

    <div id="screen-home" class="screen">
        <header class="header-main" id="admin-trigger">Hi <span id="display-first-name">Max</span></header>
        <div class="stat-card">Demerit points balance <span style="margin-left:auto; font-weight:700">0</span></div>
        <div class="stat-card">Registered vehicles <span style="margin-left:auto; font-weight:700">1</span></div>
        <div class="licence-card" onclick="navTo('licence')">
            <div style="font-size: 20px; font-weight: 700;">My licence</div>
            <div style="font-size: 14px; opacity: 0.8;">Tap to view licence</div>
        </div>
    </div>

    <div id="screen-licence" class="screen">
        <div class="lic-nav" onclick="navTo('home')">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2.5"><path d="M15 18l-6-6 6-6"/></svg>
            <span style="margin-left: 10px; font-weight: 700;">View details</span>
        </div>
        <div class="refresh-bar">Last refreshed: <span id="refresh-time"></span></div>
        <div class="banner-red">PROBATIONARY LICENCE<br>Victoria Australia</div>
        
        <div class="mint-box">
            <img id="profile-img" src="">
            <div class="qr-card" id="qr-area">
                <p style="font-size: 9px; margin-bottom: 5px; color: var(--text-light);">Presenting a QR code allows your information to be shared.</p>
                <button class="btn-reveal" onclick="revealQR()">Reveal QR code</button>
            </div>
        </div>

        <div class="details-pane">
            <h2 id="display-full-name" style="margin: 0 0 25px;">MAX T CAMERON</h2>
            <div class="grid-row">
                <div class="grid-col"><div class="label">Permit number</div><div class="value" id="val-num">060672930</div></div>
                <div class="grid-col"><div class="label">Expiry</div><div class="value" id="val-exp">30 Dec 2035</div></div>
            </div>
            <div class="grid-row">
                <div class="grid-col"><div class="label">Permit type</div><div class="value" id="val-type">Car <span style="background:var(--vic-red); color:white; padding:1px 5px; border-radius:3px;">P</span></div></div>
                <div class="grid-col"><div class="label">Date of birth</div><div class="value" id="val-dob">23 Feb 2007</div></div>
            </div>
            <div class="label">Address</div>
            <div class="value" id="val-addr">46A ELWOOD ST<br>BRIGHTON VIC 3186</div>
        </div>
        <div class="section-break">Signature</div>
        <div class="details-pane"><img id="signature-img" src=""></div>
    </div>

    <nav class="nav-bar">
        <div class="nav-btn" id="nav-home" onclick="navTo('home')">
            <div class="home-pill"><svg class="nav-icon" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg></div>
            <svg class="nav-icon static-home" viewBox="0 0 24 24" style="display:none;"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>
            <span>Home</span>
        </div>
        <div class="nav-btn" id="nav-lic" onclick="navTo('licence')">
            <svg class="nav-icon" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="16" rx="2"></rect><line x1="7" y1="8" x2="17" y2="8"></line><line x1="7" y1="12" x2="17" y2="12"></line></svg>
            <span>Licence</span>
        </div>
        <div class="nav-btn">
            <svg class="nav-icon" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
            <span>Profile</span>
        </div>
    </nav>

    <script>
        let pin = "";
        
        // Initial Load
        window.onload = () => { 
            loadData(); 
            navTo('home'); 
        };

        // ANY PIN UNLOCK LOGIC
        function press(n) {
            if(pin.length < 4) {
                pin += n;
                const dots = document.querySelectorAll('.pin-dot');
                dots[pin.length-1].classList.add('filled');
                dots[pin.length-1].innerText = "●";
                if(pin.length === 4) {
                    setTimeout(() => {
                        document.getElementById('screen-pin').style.display = 'none';
                        pin = ""; // Reset for next time
                    }, 250);
                }
            }
        }
        function del() { if(pin.length > 0) { pin = pin.slice(0,-1); const dots = document.querySelectorAll('.pin-dot'); dots[pin.length].classList.remove('filled'); dots[pin.length].innerText = ""; } }

        // NAVIGATION WITH ICON FOCUS
        function navTo(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('screen-'+id).classList.add('active');
            const homeBtn = document.getElementById('nav-home');
            const licBtn = document.getElementById('nav-lic');
            const staticHome = homeBtn.querySelector('.static-home');
            
            if(id === 'home') {
                homeBtn.classList.add('active'); 
                licBtn.classList.remove('active');
                staticHome.style.display = 'none';
            } else {
                homeBtn.classList.remove('active'); 
                licBtn.classList.add('active');
                staticHome.style.display = 'block';
                if(id === 'licence') updateTime();
            }
        }

        // 5-TAP SECRET ADMIN TRIGGER
        let taps = 0;
        document.getElementById('admin-trigger').onclick = () => { 
            taps++; 
            if(taps >= 5) { toggleAdmin(); taps = 0; } 
            setTimeout(() => taps = 0, 3000); 
        };

        function toggleAdmin() { 
            const p = document.getElementById('admin-panel'); 
            p.style.display = p.style.display === 'flex' ? 'none' : 'flex'; 
        }

        // SAVE & LOAD DATA
        async function applyChanges() {
            const data = {
                name: document.getElementById('edit-name').value || document.getElementById('display-full-name').innerText,
                num: document.getElementById('edit-num').value || document.getElementById('val-num').innerText,
                exp: document.getElementById('edit-exp').value || document.getElementById('val-exp').innerText,
                dob: document.getElementById('edit-dob').value || document.getElementById('val-dob').innerText,
                addr: document.getElementById('edit-addr').value || document.getElementById('val-addr').innerText,
                photo: await toB64(document.getElementById('edit-photo').files[0]) || document.getElementById('profile-img').src,
                sig: await toB64(document.getElementById('edit-sig').files[0]) || document.getElementById('signature-img').src
            };
            localStorage.setItem('vicDataPersistent', JSON.stringify(data));
            loadData(); 
            toggleAdmin();
        }

        function loadData() {
            const d = JSON.parse(localStorage.getItem('vicDataPersistent') || '{}');
            if(d.name) { 
                document.getElementById('display-full-name').innerText = d.name.toUpperCase(); 
                document.getElementById('display-first-name').innerText = d.name.split(' ')[0]; 
            }
            if(d.num) document.getElementById('val-num').innerText = d.num;
            if(d.exp) document.getElementById('val-exp').innerText = d.exp;
            if(d.dob) document.getElementById('val-dob').innerText = d.dob;
            if(d.addr) document.getElementById('val-addr').innerText = d.addr;
            if(d.photo) document.getElementById('profile-img').src = d.photo;
            if(d.sig) document.getElementById('signature-img').src = d.sig;
        }

        // HELPERS
        const toB64 = f => !f ? null : new Promise(r => { const rd = new FileReader(); rd.readAsDataURL(f); rd.onload = () => r(rd.result); });
        function updateTime() { document.getElementById('refresh-time').innerText = new Date().toLocaleString('en-GB', { day:'2-digit', month:'short', year:'numeric', hour:'2-digit', minute:'2-digit' }); }
        
        function revealQR() { 
            document.getElementById('qr-area').innerHTML = `<img src="https://api.qrserver.com/v1/create-qr-code/?size=140x140&data=VERIFIED" style="width:130px; height:130px;">`; 
        }
    </script>
</body>
</html>